const input = `\\-..../................\\...../....|....|...........\\...........\\....../././............../...........|........
....\\.................\\........./..........................................-..|.........../..../.........../..
.|./........................./..........-.....|..../......../.........|......../.....|.................-....-.
.--...............-.|........................\\.......\\...........|..........\\.................................
............|......|.........|.......\\..\\..../............./....-.../.........././............\\.......\\.......
..|\\.....|................/...........\\.\\....\\\\........\\.........\\..........|.......|...\\.-....-.......|./....
.........................../................................../../..|....../\\........\\................/...../.
.../.......|./-..\\....................................../....../...........-.....|.....|....../...............
...-...\\......-.........../..../.......\\\\..............-\\....../....................|.....|...........\\.......
.|............-......../...........|........|...........-/.-..........\\..............-..|............|-.......
.................\\/.........\\/..../........./......../.-\\........\\..-.......|..............|..\\..............|
......./|../..........\\/.............-........|........................\\.................................-....
....../......................................./.................--.....-.|......................\\..../........
.\\.................|............|.//....|/.............|...........\\|..........-..........-................-..
.../................|........|...-.................\\....|....|....|..............................|............
|.........-\\...-.-......./.............-.-/...............-.\\..../........................./.........\\....\\...
......|........./............\\.../\\.....-...|...............\\.....|................................\\..........
.........................................\\......\\.........................-......\\...-......../......./\\-./...
....../.../......-..................................................../|.......|........................\\.....
....................../\\/..........................|.......................................|..................
|.......\\.......................|..-..\\......\\..\\...............................................|.......|.....
................../........-...|..........................|............-........\\.......|...........\\.........
.............................|.............../.......\\....|......................./............./......./..../
.\\.............-..-...|...-.-....|......./.........../...../........./....................\\././.....|.........
..-..../....\\......................|............................................./.\\.../..........|...........
....-.........-.......\\......-.............../.............|....|......./.......\\..-.\\.....\\..-...............
..................../-.......|..../....-/...|...........-//..............-./...........-...........././.......
..............................................|.-........|...........\\..|/|..-.....-...../......../...........
...............................\\.../-..|......|......./.\\................--............-........../.....\\./...
-.............|.-......................................................|.....\\.|....-.....|......\\|........\\..
-....\\.....-...-.............../...........-.................................../.|.\\........-.................
....-....\\.-./.../..../........\\..-.............|...................|.........\\.....\\................../..\\|..
...................||..|.......|.....\\.../.....-../.....-.|............/.......-.........|........./..-......|
.........\\........-....-..-.....|..............|.........-.\\|.\\|.........\\....|.........\\.\\\\...........|.\\.|..
..........................|..|.../../...-...............-....../....................|...............-.........
...../|........|./..................-....\\.|...........|..............................\\./.../\\................
............................../..\\..\\............-.../.........-...../.......-..\\...|....../..-|-.............
..........-...../.......-................-...........|..\\|..|.\\.............../.-.../.........................
............................../..-.....-...../............................\\........|...................\\......
/./.......-|...-...\\/.......-................/.....-....\\...../..............\\../............-................
.............\\...........................-...|................................\\./..-............-........|/|./
......................./..-.......\\........./...\\..|..../.....................-.....-\\|...................../.
.....|...-....-..-/....|.|................................../............/............./..\\........./.....-...
.....|................\\.../.....\\..........................\\|...........-.\\.|./..-.....\\....../....\\....|.....
......................\\................-............../\\....||....-...-.....|......|-.......................-.
.................................|..........-......|.....-......-........|.|...../.........-......\\..../|.....
................../.......\\.....................................|......................................-......
......\\.....\\..../..-................-......................-..................................-...--.-.-.....
...........-...........\\.............................................................-.-........-.............
.|..............\\./........................../................./..-....-........|-/.../.......-........\\......
.-...-/...|.|.../..-........../..............................|.../..........\\.............-.............../.|.
.............\\..|.....\\.....\\.................-....\\...................|../.-......|.......\\..\\.../....../....
/........|....\\.........\\.....|..........\\./..\\.........-.-.......-.....|....../.......\\-\\..-..../............
..........|...|\\...|............\\......\\.............-.|...........-.....................|..................\\-
............\\.\\...../../..........................-.|...................../........\\..-....-............/.....
............./.../|...\\.......-...................\\....|....-\\..........|/.-//.\\.......\\..-.\\.....\\...\\../....
.-..............|.....|.........|......|\\................//...|...........................\\...\\...-...........
......-...\\../...........................|...............\\.||.........................-..............-........
.......-............|...|....-...\\....|...|........|..../........................................|.........\\..
........\\.|.\\....\\.\\.|...........|......./.....................\\.../.............-...|./...........\\..........
........./......-.........-................|.../...............-.............../|\\..........-./...............
...\\..........\\......./........\\........./.../........../........-......-........-......................./....
............./../........../.........../................-...............-./....-............................-.
..\\/.|....................|.....\\................-...............--...................../............./.......
.............................-....-........................................................|..........|..|....
./................................/............../..................................................|..\\.../..
...............-...............|...............................-.../.-.|..-........../.../....................
.......|...\\.............\\...\\./................-......\\..\\././........-.............../.................../..
..../..\\...-..............|./........../....../...../........\\....../......-....../..|......-.................
.............................--./..........-....\\...........|.............................../.................
.........../...............-....-|......./..........-..|.....................-......\\.\\.................../...
.-.|...-.\\................/../......\\...........|.......-...........-.........................................
./........\\-........../..........././.............|...\\................-............|....................|....
.........|..\\||............|.-..\\.................-.....-.......-..|...........\\................|......../....
....-.................\\...-......\\.........|...........\\...../.....\\.......-....................|/......-.....
......-...|...........\\.....-....................-.........../.....\\...\\......................................
../.....\\....|..-..\\.............../..........................|..\\-.\\........................|....\\....-.\\..|.
/--....|.../.........\\./.................|..-.........|....-..............................-.-../..............
.\\...............//......-........./.....................................\\|...\\......|.............../........
..........................\\.........\\..................\\..................\\.................-...|./...........
.......--................../........................|........................\\..........|.....................
.........-............................-./......./.|..................|.........\\...............|..............
...../..\\................../...-.....|...........\\|.......|...........\\........./..|....-...........-.........
....-.....\\..................|......\\.../...\\........./.....\\..............................\\./................
.\\.......\\......|......|...................\\.....-../...........................-.....-...........-/..........
.....\\........./......./..\\....................../../.......-....../.....|.........-........|.....|\\/.........
........................\\........./....................../../............-.........\\........|\\......\\-......\\.
..........................-./.....\\../..\\........./..............\\.........\\.......|...../......|.........../.
........................|......-\\...-..........|.......................-../.....|..-......................|...
.....//.../......................\\...\\............................................./..\\.|....../..........|...
-...\\.|.../....................................\\..................-.-...|..|................-..|......|.....|.
.....\\..-.......................|...|..............\\.......\\..........\\....-../......................|.-......
/\\.....-..\\.........-...|.....|.......\\../../................../.-.....\\......-.|............/.........-......
....................................././............\\........|....|........................../......../....|..
..............|................|....\\........./................||...........|................/-....\\...-......
............/|.....|.........\\..............|.....|........./....|.............../......\\............./..\\....
-...../.....\\.........-...|............./................./........../......./............./.....|........\\...
...|./......................................\\.......|...../............-...............\\.././...\\.............
..\\...............\\....../..\\....|............................\\.....|....\\....-...................-...........
..............\\.....\\......./............--..................||.......\\..-../.|.............|....../.-....\\.-.
/..............-.......................-..........................\\............\\....................|........|
......-...................../..............................\\...|.....\\../..............|...|..................
.....-.....\\...../.-........................-.........|..........\\............\\../.......|........./.-.|.....\\
....-................|...././..\\...-......./..../.........-........|/......../..........\\......|/..\\......-...
./...|..\\....|./......\\....../..........-.|..........\\.............-..........\\|.\\............................
.....|..|..../........................../......|./../...-................-|......\\............................
./|......|................|..-.............../\\....-............./-...................-.|.........|..........|
............................................|.\\........-.\\..../..|..................-.........-....-.-./......
...../............................\\...................-.-...-../...........|..|....\\...................-.....\\
......./...\\../..........-.................-.........................-........../...-......\\..................`;

const example = `.|...\\....
|.-.\\.....
.....|-...
........|.
..........
.........\\
..../.\\\\..
.-.-/..|..
.|....-|.\\
..//.|....`;

type Point = [number, number];
type Direction = [number, number];

const N: Point = [0, -1];
const E: Point = [1, 0];
const S: Point = [0, 1];
const W: Point = [-1, 0];
const forwardReflect = new Map([[N, E], [E, N], [S, W], [W, S]]);
const backwardReflect = new Map([[N, W], [E, S], [S, E], [W, N]]);

const matrix = example.split('\n').map((line) => line.split(''));
// const energized: Map<Direction, number>[][] = new Array(matrix.length).fill(null).map(() => {
//   return new Array(matrix[0].length).fill(null).map(() => new Map())
// });

// function track(node: Point, direction: Direction) {
//   const map = energized[node[1]][node[0]];
//   const count = map.get(direction);
//   let base = 0;

//   if (count === undefined) {
//     base++;
//     map.set(direction, NaN);
//   } else if (Number.isNaN(count)) {
//     return 0;
//   } else if (Number.isInteger(count)) {
//     return count;
//   }

//   const energy = base + follow([node[0] + direction[0], node[1] + direction[1]], direction);

//   map.set(direction, energy);

//   return energy;
// }

// function follow(node: Point, direction: Direction) {
//   const char = matrix[node[1]]?.[node[0]];

//   if (!char) return 0;

//   if (char === '/') {
//     return track(node, forwardReflect.get(direction));
//   }

//   if (char === '\\') {
//     return track(node, backwardReflect.get(direction));
//   }

//   if (char === '-' && (direction === N || direction === S)) {
//     return track(node, W) + track(node, E) - 1;
//   }

//   if (char === '|' && (direction === W || direction === E)) {
//     return track(node, N) + track(node, S) - 1;
//   }

//   return track(node, direction)
// }

// for (let i = 0; i < matrix[0].length; i++) {
//   follow([i, 0], S);
//   follow([i, matrix.length - 1], N);
// }

// for (let i = 0; i < matrix.length; i++) {
//   follow([matrix[0].length - 1, i], W);
//   follow([0, i], E);
// }

// console.log(follow([0, 0], E)); // Should be: 46
// console.log(follow([3, 0], S)); // Should be: 51

// Answer: ???
